<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="The New Mercurial Workflow" />
<meta property="og:description" content="There&rsquo;s a good chance you&rsquo;ve heard something about a new review tool coming to Mozilla and how it will change
everything. There&rsquo;s an even better chance you&rsquo;ve stumbled across one of gps&rsquo; blog posts on how
we use mercurial at Mozilla.

With mozreview entering beta, I decided to throw out my old mq based workflow and
try to use all the latest and greatest tools. That means mercurial bookmarks, a unified
mozilla-central, using mozreview and completely expunging mq from my workflow.

" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ahal.ca/blog/2014/new-mercurial-workflow/" />



<meta property="article:published_time" content="2014-11-09T00:00:00&#43;00:00"/>

<meta property="article:modified_time" content="2014-11-09T00:00:00&#43;00:00"/>











<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="The New Mercurial Workflow"/>
<meta name="twitter:description" content="There&rsquo;s a good chance you&rsquo;ve heard something about a new review tool coming to Mozilla and how it will change
everything. There&rsquo;s an even better chance you&rsquo;ve stumbled across one of gps&rsquo; blog posts on how
we use mercurial at Mozilla.

With mozreview entering beta, I decided to throw out my old mq based workflow and
try to use all the latest and greatest tools. That means mercurial bookmarks, a unified
mozilla-central, using mozreview and completely expunging mq from my workflow.

"/>
<meta name="generator" content="Hugo 0.42.1" />


    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "The New Mercurial Workflow",
  "url": "https://ahal.ca/blog/2014/new-mercurial-workflow/",
  "wordCount": "1209",
  "datePublished": "2014-11-09T00:00:00&#43;00:00",
  "dateModified": "2014-11-09T00:00:00&#43;00:00",
  "author": {
    "@type": "Person",
    "name": "Andrew Halberstadt"
  },
  "keywords": "ateam, mercurial, mozilla"
}
</script>



    <link rel="canonical" href="https://ahal.ca/blog/2014/new-mercurial-workflow/">

    <title>The New Mercurial Workflow | Hunting the Shmoo</title>

    <!-- combined, minified CSS -->
    <link href="https://ahal.ca/css/style.css" rel="stylesheet" integrity="sha384-TbfEhJn4HkgPUIZUhhHaAYsycYKHxSuIloCjZOiyCSpbVunRQxg5T5pxKVFwxilF" crossorigin="anonymous">

    

    

    

    <link rel="shortcut icon" href="/favicon.png">
<link href="https://ahal.ca/css/bootstrap.min.css" rel="stylesheet">
<link href="https://ahal.ca/css/override.css" rel="stylesheet">
<link href="https://ahal.ca/css/debugprint.css" rel="stylesheet">
<script type="text/javascript" src="/js/menu.js"></script>

  </head>

  <body>

    
    <div class="blog-masthead">
      <div class="container">
        <nav class="nav blog-nav">
          <a class="nav-link " href="https://ahal.ca/">Home</a>
          
          <a class="nav-link active" href="/blog/" title="">Blog</a>
          
          
          <a class="nav-link" href="/casts/" title="">Casts</a>
          
        </nav>
      </div>
    </div>
    

    
    <header class="blog-header">
      <div class="container">
        <h1 class="blog-title"><a href="https://ahal.ca/" rel="home">Hunting the Shmoo</a></h1>
        <p class="lead blog-description">Screencasts and blog posts on workflow, productivity, tools, Mozilla and whatever else tickles my fancy.</p>
      </div>
    </header>
    

    
    <div class="container">
      <div class="row">
        <div class="col-sm-8 blog-main">

          


<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="https://ahal.ca/blog/2014/new-mercurial-workflow/">The New Mercurial Workflow</a></h2>
    <p class="blog-post-meta"><time datetime="2014-11-09T00:00:00Z">Nov 09, 2014</time> by Andrew Halberstadt in 

<i class="fa fa-tag" aria-hidden="true"></i>&nbsp;<a href="/tags/ateam" rel="tag">ateam</a>, <a href="/tags/mercurial" rel="tag">mercurial</a>, <a href="/tags/mozilla" rel="tag">mozilla</a>

</p>
  </header>
  <p>There&rsquo;s a good chance you&rsquo;ve heard something about a new review tool coming to Mozilla and how it will <em>change
everything</em>. There&rsquo;s an even better chance you&rsquo;ve stumbled across one of gps&rsquo; <a href="http://gregoryszorc.com/blog/category/mercurial/">blog posts</a> on how
we use mercurial at Mozilla.</p>

<p>With <a href="https://groups.google.com/forum/#!topic/mozilla.dev.platform/RMkSXq2ckFk">mozreview entering beta</a>, I decided to throw out my old mq based workflow and
try to use all the latest and greatest tools. That means <a href="http://mercurial.selenic.com/wiki/Bookmarks">mercurial bookmarks</a>, a <a href="http://gregoryszorc.com/blog/2014/06/30/track-firefox-repositories-with-local-only-mercurial-tags/">unified
mozilla-central</a>, using <a href="http://mozilla-version-control-tools.readthedocs.org/en/latest/mozreview.html">mozreview</a> and completely <a href="http://gregoryszorc.com/blog/2014/06/23/please-stop-using-mq/">expunging mq</a> from my workflow.</p>

<p></p>

<p>Making all these changes at the same time was a little bit daunting, but the end result seems to be
a much easier and more efficient workflow. I&rsquo;m writing the steps I took down in case it helps
someone else interested in making the switch. Everything in this post is either repeating the
mozreview documentation or one of gps&rsquo; blog posts, but I figured it might help for a step by step
tutorial that puts all the pieces together, from someone who is also a mercurial noob.</p>

<h2 id="setup">Setup</h2>

<h4 id="mercurial">Mercurial</h4>

<p>Before starting you need to do a bit of setup. You&rsquo;ll need the mercurial <code>reviewboard</code> and
<code>firefoxtree</code> extensions and mercurial 3.0 or later. Luckily you can run:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ mach mercurial-setup</code></pre></div>
<p>And hitting &lsquo;yes&rsquo; to everything should get you what you need. Make sure you at least enable the
rebase extension. In my case, mercurial &gt; 3.0 didn&rsquo;t exist in my package repositories (Fedora 20)
so I had to <a href="http://mercurial.selenic.com/downloads">download</a> and install it manually.</p>

<h4 id="mozreview">MozReview</h4>

<p>There is also some setup required to use the mozreview tool. Follow the <a href="http://mozilla-version-control-tools.readthedocs.org/en/latest/mozreview/install.html">instructions</a> to get
started.</p>

<h4 id="tagging-the-baseline">Tagging the Baseline</h4>

<p>Because we enabled the <code>firefoxtree</code> extension, anytime we pull a remote repo from hg.mozilla.org, a
local tag will be created for us. So before proceeding further, make sure we have our baseline
tagged:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hg pull https://hg.mozilla.org/mozilla-central
$ hg log -r central</code></pre></div>
<p>Now we know where mozilla-central tip is. This is important because we&rsquo;ll be pulling mozilla-inbound
on top later.</p>

<h4 id="create-path-aliases">Create path Aliases</h4>

<p>Edit: Apparently the <a href="https://mozilla-version-control-tools.readthedocs.org/en/latest/hgmozilla/firefoxtree.html">firefoxtree</a> extension provides built-in aliases so there&rsquo;s no need to do
this step. The aliases follow the <code>central</code>, <code>inbound</code>, <code>aurora</code> convention. Just be aware that you
won&rsquo;t be able to push to these default aliases. If you want to push, you&rsquo;ll need to add your own
custom aliases with ssh:// urls, e.g <code>ssh://hg.mozilla.org/mozilla-central</code>.</p>

<p><strike>
Typing the url out each time is tiresome, so I recommend creating path aliases in your ~/.hgrc:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ini" data-lang="ini"><span style="color:#66d9ef">[paths]</span>
<span style="color:#a6e22e">m-c</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">https://hg.mozilla.org/mozilla-central</span>
<span style="color:#a6e22e">m-i</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">https://hg.mozilla.org/integration/mozilla-inbound</span>
<span style="color:#a6e22e">m-a</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">https://hg.mozilla-org/releases/mozilla-aurora</span>
<span style="color:#a6e22e">m-b</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">https://hg.mozilla-org/releases/mozilla-beta</span>
<span style="color:#a6e22e">m-r</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">https://hg.mozilla-org/releases/mozilla-release</span></code></pre></div>
<p></strike></p>

<h4 id="learning-bookmarks">Learning Bookmarks</h4>

<p>It&rsquo;s a good idea to be at least somewhat familiar with bookmarks before starting. Reading <a href="http://mozilla-version-control-tools.readthedocs.org/en/latest/mozreview/install.html">this
tutorial</a> is a great primer on what to expect.</p>

<h2 id="start-working-on-a-bug">Start Working on a Bug</h2>

<p>Now that we&rsquo;re all set up and we understand the basics of bookmarks, it&rsquo;s time to get started.
Create a bookmark for the feature work you want to do:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hg bookmark my_feature</code></pre></div>
<p>Make changes and commit as often as you want. Make sure at least one of the commits has the bug number
associated with your work, this will be used by mozreview later:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">... <span style="color:#66d9ef">do</span> some changes ...
$ hg commit -m <span style="color:#e6db74">&#34;Bug 1234567 - Fix that thing that is broken&#34;</span>
... <span style="color:#66d9ef">do</span> more changes ...
$ hg commit -m <span style="color:#e6db74">&#34;Only one commit message needs a bug number&#34;</span></code></pre></div>
<p>Maybe you want to pull central again and rebase your changes on top of it. No problem:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hg update central
$ hg pull m-c
$ hg rebase -b my_feature -d central</code></pre></div>
<h2 id="pushing-a-bookmark-for-review">Pushing a Bookmark for Review</h2>

<p>When you are ready for review, all you do is:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hg update my_feature
$ hg push review</code></pre></div>
<p>Mercurial will automatically push the currently active bookmark to the review repository. This is
equivalent (no need to update):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hg push -r my_feature review</code></pre></div>
<p>At this point you should see some links being dumped to the console, one for each commit in your
bookmark as well as a parent link to the overall review. Open this last link to see your review
request. At this stage, the review is unpublished, you&rsquo;ll need to add some reviewers and publish it
before anyone else can see it. Instead of explaining how to do this, I highly recommend reading the
<a href="http://mozilla-version-control-tools.readthedocs.org/en/latest/mozreview/reviewboard.html">mozreview instructions</a> carefully. I would have saved myself a lot of time if I had just paid
closer attention to them.</p>

<p>Once published, mozreview will automatically update the associated bug with appropriate information.</p>

<h2 id="fixing-review-comments">Fixing Review Comments</h2>

<p>If all went well, someone has received your review request. If you need to make some follow up
changes, it&rsquo;s super easy. Just activate the bookmark, make a new commit and re-push:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hg update my_feature
... fix review comments ...
$ hg commit -m <span style="color:#e6db74">&#34;Address review comments&#34;</span>
$ hg push review</code></pre></div>
<p>Mozreview will automatically detect which commits have been pushed to the review server and update
the review accordingly. In the reviewboard UI it will be possible for reviewers to see both the
interdiff and the full diff by moving a push slider around.</p>

<h2 id="pushing-to-inbound">Pushing to Inbound</h2>

<p>Once you&rsquo;ve received the r+, it&rsquo;s time to push to mozilla-inbound. Remember that <code>firefoxtree</code> makes
local tags when you pull from a remote repo on hg.mozilla.org, so let&rsquo;s do that:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hg update central
$ hg pull m-i
$ hg log -r inbound</code></pre></div>
<p>Next we rebase our bookmark on top of inbound. In this case I want to use the &ndash;collapse argument to
fold the review changes into the original commit:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hg rebase -b my_feature -d inbound --collapse</code></pre></div>
<p>A file will open in your default editor where you can modify the commit message to whatever you
want. In this case I&rsquo;ll just delete everything except the original commit message and add &ldquo;r=&rdquo;.</p>

<p>And now everything is ready! Verify you are pushing what you expect and push:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hg outgoing -r my_feature m-i
$ hg push -r my_feature m-i</code></pre></div>
<h2 id="pushing-to-other-branches">Pushing to other Branches</h2>

<p>The beauty of this system is that it is trivial to land patches on any tree you want. If I wanted to
land <code>my_feature</code> on aurora:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hg pull m-a
$ hg rebase -b my_feature -d aurora
$ hg outgoing -r my_feature m-a
$ hg push -r my_feature m-a</code></pre></div>
<h2 id="syncing-work-across-computers">Syncing work across Computers</h2>

<p>You can use a remote clone of mozilla-central to sync bookmarks between computers. Instead of
pushing with <code>-r</code>, push with <code>-B</code>. This will publish the bookmark on the remote server:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hg push -B my_feature &lt;my remote mercurial server&gt;</code></pre></div>
<p>From another computer, you can pull the bookmark in the same way:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hg pull -B my_feature &lt;my remote mercurial server&gt;</code></pre></div>
<p>WARNING: Mercurial repositories are publishing by default! This means that when you push a commit to
them, they will mark the commit as public on your local clone which means you won&rsquo;t be able to push
them to either the review server or mozilla-inbound. If you did this by accident and a commit was
made public when it shouldn&rsquo;t be, you can run:</p>

<pre><code>$ hg phase -f --draft &lt;rev&gt;
</code></pre>

<p>To prevent this, you can make a repository non-publishing by adding the following to its <code>.hg/hgrc</code>
file:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ini" data-lang="ini"><span style="color:#66d9ef">[phases]</span>
<span style="color:#a6e22e">publish</span><span style="color:#f92672">=</span><span style="color:#e6db74">false</span></code></pre></div>
<h2 id="conclusion">Conclusion</h2>

<p>I&rsquo;ll need to play around with things a little more, but so far everything has been working exactly
as advertised. Kudos to everyone involved in making this workflow possible!</p>

  

  
  <hr>
  <footer>

  
    <section>
    <h4>Share</h4>
    <nav class="nav sharing-icons">
      <a class="nav-item" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fahal.ca%2fblog%2f2014%2fnew-mercurial-workflow%2f" title="Share on Facebook"><span class="fa fa-facebook fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://plus.google.com/share?url=https%3a%2f%2fahal.ca%2fblog%2f2014%2fnew-mercurial-workflow%2f" title="Share on Google+"><span class="fa fa-google-plus fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fahal.ca%2fblog%2f2014%2fnew-mercurial-workflow%2f" title="Share on LinkedIn"><span class="fa fa-linkedin fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://twitter.com/home?status=https%3a%2f%2fahal.ca%2fblog%2f2014%2fnew-mercurial-workflow%2f" title="Tweet this"><span class="fa fa-twitter fa-2x"></span></a>
    </nav>
  </section>

  

  

  
    <section class="post-comments">
      



















  <h4>Comments</h4>
  
  
    <div class="post-comment">
      <div class="post-comment-header">
        <img class="post-comment-avatar" src="https://www.gravatar.com/avatar/gregory.szorc@gmail.com?s=100">
        <p class="post-comment-info"><strong>Gregory Szorc</strong><br>08/11/2014</p>
      </div>
      <p>Excellent post!</p><p>I guess you didn't know that firefoxtree automatically creates aliases for the Firefox repositories. i.e. `hg pull central` just works with no hgrc hacking needed.</p><p>This blog post inspired me to write up some Sphinx docs for firefoxtree tree so its awesomeness is fully realized. Stay tuned...</p>

    </div>
  
    <div class="post-comment">
      <div class="post-comment-header">
        <img class="post-comment-avatar" src="https://www.gravatar.com/avatar/halbersa@gmail.com?s=100">
        <p class="post-comment-info"><strong>ahal</strong><br>08/11/2014</p>
      </div>
      I didn't. I actually had a 'central = ... ' alias already, so I didn't notice. In the post I changed it to 'm-c' to differentiate it from the local tag, but I guess there's no need for that. Thanks for pointing it out though, I'll update the post.
    </div>
  
    <div class="post-comment">
      <div class="post-comment-header">
        <img class="post-comment-avatar" src="https://www.gravatar.com/avatar/gregory.szorc@gmail.com?s=100">
        <p class="post-comment-info"><strong>Gregory Szorc</strong><br>08/11/2014</p>
      </div>
      And <a href="https://mozilla-version-control-tools.readthedocs.org/en/latest/hgmozilla/firefoxtree.html" rel="nofollow noopener" title="https://mozilla-version-control-tools.readthedocs.org/en/latest/hgmozilla/firefoxtree.html">https://mozilla-version-con...</a> is live.
    </div>
  
    <div class="post-comment">
      <div class="post-comment-header">
        <img class="post-comment-avatar" src="https://www.gravatar.com/avatar/cpeterson@mozilla.com?s=100">
        <p class="post-comment-info"><strong>Chris</strong><br>10/11/2014</p>
      </div>
      Thanks for sharing, Andrew. This was a great introduction to bookmarks and reviewboard. I'm going to throw out my old hg and mq shortcuts and try to stick with this new workflow. :)
    </div>
  
    <div class="post-comment">
      <div class="post-comment-header">
        <img class="post-comment-avatar" src="https://www.gravatar.com/avatar/mathias.demare@gmail.com?s=100">
        <p class="post-comment-info"><strong>Mathiasdm</strong><br>10/11/2014</p>
      </div>
      <p>"This is enough of a pain that I'd recommend avoiding user repositories for this purpose unless you<br>can figure out how to make them non-publishing."</p><p>I would propose you mention how to make them non-publishing, it only requires:</p><p>[phases]<br>publish = False</p><p>Nice post, by the way!</p>

    </div>
  
    <div class="post-comment">
      <div class="post-comment-header">
        <img class="post-comment-avatar" src="https://www.gravatar.com/avatar/halbersa@gmail.com?s=100">
        <p class="post-comment-info"><strong>ahal</strong><br>10/11/2014</p>
      </div>
      Good point. In the case of user repos, I don't think most people have <br>permission to ssh in and make this change (someone correct me if I'm wrong). But it's a necessary step no <br>matter where it lives. Updated!
    </div>
  
    <div class="post-comment">
      <div class="post-comment-header">
        <img class="post-comment-avatar" src="https://www.gravatar.com/avatar/jryans@gmail.com?s=100">
        <p class="post-comment-info"><strong>J. Ryan Stinnett</strong><br>11/11/2014</p>
      </div>
      What do the steps to rebase a long-lived feature branch look like with this workflow?
    </div>
  
    <div class="post-comment">
      <div class="post-comment-header">
        <img class="post-comment-avatar" src="https://www.gravatar.com/avatar/halbersa@gmail.com?s=100">
        <p class="post-comment-info"><strong>ahal</strong><br>11/11/2014</p>
      </div>
      <p>You mean a twig like alder or birch? As long as it's a repo firefoxtree knows about (<a href="https://hg.mozilla.org/hgcustom/version-control-tools/file/a7462aae407b/pylib/mozautomation/mozautomation/repository.py#l45)" rel="nofollow noopener" title="https://hg.mozilla.org/hgcustom/version-control-tools/file/a7462aae407b/pylib/mozautomation/mozautomation/repository.py#l45)">https://hg.mozilla.org/hgcu...</a> then it shouldn't be any different from rebasing on top of central.</p><p>hg rebase works similarly to git rebase. If there's a conflict it will suspend, you have to fix the conflict manually and then run `hg rebase --continue`.</p>

    </div>
  
    <div class="post-comment">
      <div class="post-comment-header">
        <img class="post-comment-avatar" src="https://www.gravatar.com/avatar/nthomas@mozilla.com?s=100">
        <p class="post-comment-info"><strong>nthomas</strong><br>12/11/2014</p>
      </div>
      gps is already on this case, see <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1089385" rel="nofollow noopener" title="https://bugzilla.mozilla.org/show_bug.cgi?id=1089385">https://bugzilla.mozilla.or...</a>
    </div>
  
    <div class="post-comment">
      <div class="post-comment-header">
        <img class="post-comment-avatar" src="https://www.gravatar.com/avatar/j.parkouss@gmail.com?s=100">
        <p class="post-comment-info"><strong>parkouss</strong><br>10/06/2015</p>
      </div>
      Excellent post, thanks!
    </div>
  
    <div class="post-comment">
      <div class="post-comment-header">
        <img class="post-comment-avatar" src="https://www.gravatar.com/avatar/yarik.sheptykin@googlemail.com?s=100">
        <p class="post-comment-info"><strong>Yarik Sheptykin</strong><br>11/01/2017</p>
      </div>
      <p>Thanks for sharing!</p><p>I have been using this workflow for about a year now and can report that rebase extension is not very helpful when conflicts arise. This makes bookmark workflow comfortable for short-lived patches. Whenever you changeset lives long enough to race with somebody else's work you will have hard times keeping up with central. rebase would live you with a bunch of .rej files without hinting where the merge broke. This problems might affect changesets that touch many things. To my experience using mq in such situations is more comfortable.</p>

    </div>
  
    <div class="post-comment">
      <div class="post-comment-header">
        <img class="post-comment-avatar" src="https://www.gravatar.com/avatar/halbersa@gmail.com?s=100">
        <p class="post-comment-info"><strong>ahal</strong><br>11/01/2017</p>
      </div>
      <p>Whether .rej files show up or not depends on how you have mercurial configured. For example, you could install meld (<a href="http://meldmerge.org/)" rel="nofollow noopener" title="http://meldmerge.org/)">http://meldmerge.org/)</a>, then add:</p><p>[ui]<br>merge = meld</p><p>To your hgrc. Now when hitting conflicts you'll be using a proper 3-way merge tool. I use meld and have not seen .rej files since switching from mq. Meld is just one example, you could use kdiff3 or vimdiff or whatever you want.</p>

    </div>
  























      <br>
      <h4>Leave a comment</h4>
<form class="post-new-comment" method="POST" action="https://api.staticman.net/v2/entry/ahal/hunting-the-shmoo/master/comments">
    <input type="hidden" name="options[redirect]" value="https://ahal.ca/blog/2014/new-mercurial-workflow/#comment-submitted">
    <input type="hidden" name="options[slug]" value="new-mercurial-workflow">
    <input class="post-comment-field" name="fields[name]" type="text" placeholder="Name (required)">
    <input class="post-comment-field" name="fields[email]" type="email" placeholder="E-mail (optional)">
    <textarea class="post-comment-field" name="fields[msg]" placeholder="Message (required, markdown enabled)" rows="10"></textarea>
    <input class="post-comment-field btn" type="submit" value="Submit">
</form>

<div id="comment-submitted">
  <p>Your comment has been submitted and will be published once it has been approved.</p>
</div>

    </section>
  
  </footer>
  

</article> 



        </div> <!-- /.blog-main -->

        <aside class="col-sm-3 ml-auto blog-sidebar">
  

  
        <section class="sidebar-module">
    <h4>Recent Posts</h4>
    <ol class="list-unstyled">


<li><a href="/casts/2019/task-configuration-at-scale/">Task Configuration at Scale</a></li>

<li><a href="/casts/2018/taskgraph-like-a-pro/">Taskgraph Like a Pro</a></li>

<li><a href="/blog/2018/website-refresh/">A New Look and Feel (and everything else)</a></li>

<li><a href="/blog/2017/mach-try-fuzzy/">Try Fuzzy: A Try Syntax Alternative</a></li>

<li><a href="/blog/2017/mercurial-absorb/">Absorbing Changes into a Commit Series with Mercurial</a></li>

<li><a href="/blog/2017/fuzzy-try-chooser/">A Course of Action for Replacing Try Syntax</a></li>

<li><a href="/blog/2016/taskcluster-interactive-loaner/">Using One Click Loaner to Debug Failures</a></li>

<li><a href="/blog/2016/zen-of-mach/">The Zen of Mach</a></li>

<li><a href="/blog/2015/try-syntax/">Looking beyond Try Syntax</a></li>

<li><a href="/blog/2015/making-mercurial-bookmarks-more-git-like/">Making mercurial bookmarks more git-like</a></li>

    </ol>
  </section>

  

  

  
  <section class="sidebar-module tag-cloud">
    <h4>Tag Cloud</h4>
    
    
        
            
            <a href="/tags/mozilla">mozilla</a>
        
    
        
            
            <a href="/tags/ateam">ateam</a>
        
    
        
            
            <a href="/tags/b2g">b2g</a>
        
    
        
            
            <a href="/tags/mercurial">mercurial</a>
        
    
        
            
            <a href="/tags/mach">mach</a>
        
    
        
            
            <a href="/tags/fzf">fzf</a>
        
    
        
            
            <a href="/tags/programming">programming</a>
        
    
        
            
            <a href="/tags/try">try</a>
        
    
        
            
            <a href="/tags/mozconfigwrapper">mozconfigwrapper</a>
        
    
        
            
            <a href="/tags/mozmill">mozmill</a>
        
    
        
            
            <a href="/tags/python">python</a>
        
    
        
            
            <a href="/tags/taskgraph">taskgraph</a>
        
    
        
            
            <a href="/tags/website">website</a>
        
    
        
            
            <a href="/tags/absorb">absorb</a>
        
    
        
            
            <a href="/tags/addon">addon</a>
        
    
        
            
            <a href="/tags/android">android</a>
        
    
        
            
            <a href="/tags/bookbinder">bookbinder</a>
        
    
        
            
            <a href="/tags/cycling">cycling</a>
        
    
        
            
            <a href="/tags/django">django</a>
        
    
        
            
            <a href="/tags/hugo">hugo</a>
        
    
        
            
            <a href="/tags/mozharness">mozharness</a>
        
    
        
            
            <a href="/tags/mozprofile">mozprofile</a>
        
    
        
            
            <a href="/tags/music">music</a>
        
    
        
            
            <a href="/tags/peptest">peptest</a>
        
    
        
            
            <a href="/tags/qqver">qqver</a>
        
    
        
            
            <a href="/tags/reddit">reddit</a>
        
    
        
            
            <a href="/tags/reftest">reftest</a>
        
    
        
            
            <a href="/tags/staticman">staticman</a>
        
    
        
            
            <a href="/tags/taskcluster">taskcluster</a>
        
    
        
            
            <a href="/tags/test-informant">test-informant</a>
        
    
        
            
            <a href="/tags/toronto">toronto</a>
        
    
  </section>
  
</aside>


      </div> <!-- /.row -->
    </div> <!-- /.container -->
    

    
    <footer class="blog-footer">
      <p>
      
      Â© 2018 Andrew Halberstadt
      
      </p>
      <p>
      <a href="#">Back to top</a>
      </p>
    </footer>
    

  </body>

</html>
