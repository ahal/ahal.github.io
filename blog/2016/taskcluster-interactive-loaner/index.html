<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Using One Click Loaner to Debug Failures" />
<meta property="og:description" content="One of the most painful aspects of a developer&rsquo;s work cycle is trying to fix failures that show up
on try, but which can&rsquo;t be reproduced locally. When this happens, there were really only two
options (neither of them nice):


You could spam try with print debugging. But this isn&rsquo;t very powerful, and takes forever to get
feedback.
You could request a loaner from releng. But this is a heavy handed process, and once you have the
loaner it is very hard to get tests up and running.


I&rsquo;m pleased to announce there is now a third option, which is easy, powerful and 100% self-serve.
Rather than trying to explain it in words, here is a ~5 minute demo:





" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ahal.ca/blog/2016/taskcluster-interactive-loaner/" />



<meta property="article:published_time" content="2016-08-04T00:00:00&#43;00:00"/>

<meta property="article:modified_time" content="2016-08-04T00:00:00&#43;00:00"/>











<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Using One Click Loaner to Debug Failures"/>
<meta name="twitter:description" content="One of the most painful aspects of a developer&rsquo;s work cycle is trying to fix failures that show up
on try, but which can&rsquo;t be reproduced locally. When this happens, there were really only two
options (neither of them nice):


You could spam try with print debugging. But this isn&rsquo;t very powerful, and takes forever to get
feedback.
You could request a loaner from releng. But this is a heavy handed process, and once you have the
loaner it is very hard to get tests up and running.


I&rsquo;m pleased to announce there is now a third option, which is easy, powerful and 100% self-serve.
Rather than trying to explain it in words, here is a ~5 minute demo:





"/>
<meta name="generator" content="Hugo 0.38.2" />


    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Using One Click Loaner to Debug Failures",
  "url": "https://ahal.ca/blog/2016/taskcluster-interactive-loaner/",
  "wordCount": "458",
  "datePublished": "2016-08-04T00:00:00&#43;00:00",
  "dateModified": "2016-08-04T00:00:00&#43;00:00",
  "author": {
    "@type": "Person",
    "name": "Andrew Halberstadt"
  },
  "keywords": "ateam, mozilla, taskcluster"
}
</script>



    <link rel="canonical" href="https://ahal.ca/blog/2016/taskcluster-interactive-loaner/">

    <title>Using One Click Loaner to Debug Failures | Hunting the Shmoo</title>

    <!-- combined, minified CSS -->
    <link href="https://ahal.ca/css/style.css" rel="stylesheet" integrity="sha384-ZwlQQbzhEPf3PrXZ3h/XKT/4UHafQ/TYI72AL&#43;7WOJ8D6JmpGC8JMMse6xX7cyeI" crossorigin="anonymous">

    

    

    

    <link rel="shortcut icon" href="/favicon.png">
<link href="https://ahal.ca/css/override.css" rel="stylesheet">
<script type="text/javascript" src="/js/menu.js"></script>

  </head>

  <body>

    
    <div class="blog-masthead">
  <div class="container">
    <nav class="nav blog-nav">
      <a class="nav-link" href="https://ahal.ca/"></a>
      
      <a class="nav-link active" href="/blog/" title="">Blog</a>
      
    </nav>
  </div>
</div>

    

    
    
    

    
    <div class="container">
      <div class="row">
        <div class="col-sm-8 blog-main">

          


<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="https://ahal.ca/blog/2016/taskcluster-interactive-loaner/">Using One Click Loaner to Debug Failures</a></h2>
    <p class="blog-post-meta"><time datetime="2016-08-04T00:00:00Z">Aug 04, 2016</time> by Andrew Halberstadt in 

<i class="fa fa-tag" aria-hidden="true"></i>&nbsp;<a href="/tags/ateam" rel="tag">ateam</a>, <a href="/tags/mozilla" rel="tag">mozilla</a>, <a href="/tags/taskcluster" rel="tag">taskcluster</a>

</p>
  </header>
  <p>One of the most painful aspects of a developer&rsquo;s work cycle is trying to fix failures that show up
on try, but which can&rsquo;t be reproduced locally. When this happens, there were really only two
options (neither of them nice):</p>

<ol>
<li>You could spam try with print debugging. But this isn&rsquo;t very powerful, and takes forever to get
feedback.</li>
<li>You could request a loaner from releng. But this is a heavy handed process, and once you have the
loaner it is very hard to get tests up and running.</li>
</ol>

<p>I&rsquo;m pleased to announce there is now a third option, which is easy, powerful and 100% self-serve.
Rather than trying to explain it in words, here is a ~5 minute demo:</p>

<video width="100%" height="100%" controls>
<source src="/static/vid/blog/2016/taskcluster-interactive-loaner.mp4" type="video/mp4">
</video>

<p></p>

<p>Because I&rsquo;m too lazy to re-record, I want to clarify that when I said |mach reftest| was &ldquo;identical&rdquo;
to the command line that mozharness would have run, I meant other than the test selection arguments.
You&rsquo;ll still need to either pass in a test path or use chunking arguments to select which tests to
run.</p>

<h2 id="caveats-and-known-issues">Caveats and Known Issues</h2>

<p>Before getting too excited, here is the requisite list of caveats.</p>

<ol>
<li>This only works with taskcluster jobs that have one-click-loaner enabled. This means there is no
Windows or OS X support. Getting support here is obviously the most important thing we can do to
improve this system, but it&rsquo;s a hard problem with lots of unsolved dependencies. The biggest
blocker is even just getting these platforms to work on AWS in the first place.</li>
<li>The test package mach environment doesn&rsquo;t support all test harnesses yet. I&rsquo;ve got the major 3
(mochitest, reftest, xpcshell) working so far and plan to add support for more harnesses later on
in the quarter.</li>
<li>There are many rough edges. I consider this workflow to be &ldquo;beta&rdquo; quality. Though I think it is
already useful enough to advertise, it is a long shot from being perfect. Please file bugs or
ping me with any issues or annoyances you come across. See the next session for known issues.</li>
</ol>

<h3 id="issues">Issues</h3>

<ul>
<li>No Windows or OS X support</li>
<li>Hard to find &ldquo;One-Click Loaner&rdquo; link in treeherder</li>
<li>Confusing error message if not logged into taskcluster-tools</li>
<li>Interactive tasks should be high priority so they&rsquo;re never &ldquo;pending&rdquo;</li>
<li>Scrolling in the interactive shell is broken</li>
<li>No support for harnesses other than mochitest, reftest and xpcshell</li>
<li>Android workflow needs to be ironed out</li>
<li>Cloning gecko using interactive wizard is slow</li>
</ul>

<h2 id="thanks">Thanks</h2>

<p>Finally I want to thank the taskcluster team (especially jonasfj and garndt) for implementing the
One-Click Loaner, it is seriously cool. I also want to thank armenzg for helping with reviews and
dustin for helping me navigate taskcluster and docker.</p>

<p>As always, please let me know if you have any problems, questions or suggestions!</p>

  

  
  <hr>
  <footer>

  
    <section>
    <h4>Share</h4>
    <nav class="nav sharing-icons">
      <a class="nav-item" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fahal.ca%2fblog%2f2016%2ftaskcluster-interactive-loaner%2f" title="Share on Facebook"><span class="fa fa-facebook fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://plus.google.com/share?url=https%3a%2f%2fahal.ca%2fblog%2f2016%2ftaskcluster-interactive-loaner%2f" title="Share on Google+"><span class="fa fa-google-plus fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fahal.ca%2fblog%2f2016%2ftaskcluster-interactive-loaner%2f" title="Share on LinkedIn"><span class="fa fa-linkedin fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://twitter.com/home?status=https%3a%2f%2fahal.ca%2fblog%2f2016%2ftaskcluster-interactive-loaner%2f" title="Tweet this"><span class="fa fa-twitter fa-2x"></span></a>
    </nav>
  </section>

  

  

  
    <section class="post-comments">
      































  <h4>Comments</h4>
  
  
    <div class="post-comment">
      <div class="post-comment-header">
        <img class="post-comment-avatar" src="https://www.gravatar.com/avatar/b56girard@gmail.com?s=100">
        <p class="post-comment-info"><strong>Benoit Girard</strong><br>04/08/2016</p>
      </div>
      Looks amazing! If we can get a way to dispatch to Digital Ocean instead of EC2 we can use RR to record/replay :). Would be neat if it's not too much work.
    </div>
  
    <div class="post-comment">
      <div class="post-comment-header">
        <img class="post-comment-avatar" src="https://www.gravatar.com/avatar/jopsen@gmail.com?s=100">
        <p class="post-comment-info"><strong>Jonas</strong><br>04/08/2016</p>
      </div>
      @benoit_girard:disqus, jhford is currently working on a provisioning service for Digital Ocean, once that's up deploying our worker there shouldn't be too hard.. Obviously, that'll be different hardware from what the EC2 nodes are running on, but same docker images.
    </div>
  
    <div class="post-comment">
      <div class="post-comment-header">
        <img class="post-comment-avatar" src="https://www.gravatar.com/avatar/notmyemail@letthemeatspam.com?s=100">
        <p class="post-comment-info"><strong>John Ford (jhford)</strong><br>04/08/2016</p>
      </div>
      Hi.  I'm writing the piece we need to support Digitial Ocean.  The API looks a lot better than EC2s, so let's see how it goes :)
    </div>
  
    <div class="post-comment">
      <div class="post-comment-header">
        <img class="post-comment-avatar" src="https://www.gravatar.com/avatar/mstange@themasta.com?s=100">
        <p class="post-comment-info"><strong>Markus Stange</strong><br>04/08/2016</p>
      </div>
      This is AMAZING!!
    </div>
  
    <div class="post-comment">
      <div class="post-comment-header">
        <img class="post-comment-avatar" src="https://www.gravatar.com/avatar/halbersa@gmail.com?s=100">
        <p class="post-comment-info"><strong>ahal</strong><br>04/08/2016</p>
      </div>
      Awesome, I didn't know that RR worked on DO, nor that TC support for DO was underway. Being able to run RR with One Click Loaner will be huge!
    </div>
  
    <div class="post-comment">
      <div class="post-comment-header">
        <img class="post-comment-avatar" src="https://www.gravatar.com/avatar/joel.maher@gmail.com?s=100">
        <p class="post-comment-info"><strong>Joel Maher</strong><br>08/08/2016</p>
      </div>
      does RR work on a process running inside of docker?  We might need to run docker with different permissions- it might not be as straightforward.
    </div>
  









      <br>
      <h4>Leave a comment</h4>
<form class="post-new-comment" method="POST" action="https://api.staticman.net/v2/entry/ahal/hunting-the-shmoo/master/comments">
    <input type="hidden" name="options[redirect]" value="https://ahal.ca/blog/2016/taskcluster-interactive-loaner/#comment-submitted">
    <input type="hidden" name="options[slug]" value="taskcluster-interactive-loaner">
    <input class="post-comment-field" name="fields[name]" type="text" placeholder="Name (required)">
    <input class="post-comment-field" name="fields[email]" type="email" placeholder="E-mail (optional)">
    <input class="post-comment-field" name="fields[url]" type="text" placeholder="Website or social media (optional)">
    <textarea class="post-comment-field" name="fields[msg]" placeholder="Message (required, markdown enabled)" rows="10"></textarea>
    <input class="post-comment-field btn" type="submit" value="Submit">
</form>

<div id="comment-submitted">
  <p>Your comment has been submitted and will be published once it has been approved.</p>
</div>

    </section>
  
  </footer>
  

</article> 



        </div> <!-- /.blog-main -->

        <aside class="col-sm-3 ml-auto blog-sidebar">
  

  
        <section class="sidebar-module">
    <h4>Recent Posts</h4>
    <ol class="list-unstyled">


<li><a href="/blog/2017/mach-try-fuzzy/">Try Fuzzy: A Try Syntax Alternative</a></li>

<li><a href="/blog/2017/mercurial-absorb/">Absorbing Changes into a Commit Series with Mercurial</a></li>

<li><a href="/blog/2017/fuzzy-try-chooser/">A Course of Action for Replacing Try Syntax</a></li>

<li><a href="/blog/2016/taskcluster-interactive-loaner/">Using One Click Loaner to Debug Failures</a></li>

<li><a href="/blog/2016/zen-of-mach/">The Zen of Mach</a></li>

<li><a href="/blog/2015/try-syntax/">Looking beyond Try Syntax</a></li>

<li><a href="/blog/2015/making-mercurial-bookmarks-more-git-like/">Making mercurial bookmarks more git-like</a></li>

<li><a href="/blog/2015/new-mercurial-workflow-part-2/">The New Mercurial Workflow - Part 2</a></li>

<li><a href="/blog/2014/consume-structured-test-results/">How to Consume Structured Test Results</a></li>

<li><a href="/blog/2014/new-mercurial-workflow/">The New Mercurial Workflow</a></li>

    </ol>
  </section>

  

  

  
  <section class="sidebar-module tag-cloud">
    <h4>Tag Cloud</h4>
    
    
        
            
            <a href="/tags/mozilla">mozilla</a>
        
    
        
            
            <a href="/tags/ateam">ateam</a>
        
    
        
            
            <a href="/tags/b2g">b2g</a>
        
    
        
            
            <a href="/tags/mercurial">mercurial</a>
        
    
        
            
            <a href="/tags/mach">mach</a>
        
    
        
            
            <a href="/tags/programming">programming</a>
        
    
        
            
            <a href="/tags/try">try</a>
        
    
        
            
            <a href="/tags/fzf">fzf</a>
        
    
        
            
            <a href="/tags/mozconfigwrapper">mozconfigwrapper</a>
        
    
        
            
            <a href="/tags/mozmill">mozmill</a>
        
    
        
            
            <a href="/tags/python">python</a>
        
    
        
            
            <a href="/tags/absorb">absorb</a>
        
    
        
            
            <a href="/tags/addon">addon</a>
        
    
        
            
            <a href="/tags/android">android</a>
        
    
        
            
            <a href="/tags/bookbinder">bookbinder</a>
        
    
        
            
            <a href="/tags/cycling">cycling</a>
        
    
        
            
            <a href="/tags/django">django</a>
        
    
        
            
            <a href="/tags/mozharness">mozharness</a>
        
    
        
            
            <a href="/tags/mozprofile">mozprofile</a>
        
    
        
            
            <a href="/tags/music">music</a>
        
    
        
            
            <a href="/tags/peptest">peptest</a>
        
    
        
            
            <a href="/tags/qqver">qqver</a>
        
    
        
            
            <a href="/tags/reddit">reddit</a>
        
    
        
            
            <a href="/tags/reftest">reftest</a>
        
    
        
            
            <a href="/tags/taskcluster">taskcluster</a>
        
    
        
            
            <a href="/tags/test-informant">test-informant</a>
        
    
        
            
            <a href="/tags/toronto">toronto</a>
        
    
  </section>
  
</aside>


      </div> <!-- /.row -->
    </div> <!-- /.container -->
    

    
    <footer class="blog-footer">
  <p>
  
  © 2018 Andrew Halberstadt
  
  </p>
  <p>
  <a href="#">Back to top</a>
  </p>
</footer>

    
  </body>

</html>
